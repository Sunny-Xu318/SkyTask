{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport { computed, ref, watch } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport { useStore } from 'vuex';\nimport { Setting, Monitor, Collection, Cpu } from '@element-plus/icons-vue';\nexport default {\n  __name: 'App',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const route = useRoute();\n    const store = useStore();\n    const layoutSize = ref('default');\n    const activeEnv = ref(store.getters['auth/currentEnv']);\n    const environments = computed(() => store.getters['auth/environments']);\n    const activeMenu = computed(() => route.path);\n    const breadcrumb = computed(() => store.getters['ui/breadcrumbs']);\n    const profile = computed(() => store.getters['auth/profile']);\n    const canViewDashboard = computed(() => store.getters['auth/hasPermission']('task:read'));\n    const canViewTasks = computed(() => store.getters['auth/hasPermission']('task:read'));\n    const canViewNodes = computed(() => store.getters['auth/hasPermission']('node:read'));\n    const canViewConfig = computed(() => store.getters['auth/hasPermission']('config:write'));\n    const activeEnvLabel = computed(() => {\n      const env = environments.value.find(item => item.value === activeEnv.value);\n      return env ? env.label : '未知环境';\n    });\n    const avatarInitials = computed(() => {\n      if (!profile.value?.displayName && !profile.value?.username) {\n        return 'NA';\n      }\n      const name = profile.value.displayName || profile.value.username;\n      return name.slice(0, 2).toUpperCase();\n    });\n    watch(() => route.meta?.breadcrumbs, crumbs => {\n      store.dispatch('ui/setBreadcrumbs', crumbs || []);\n    }, {\n      immediate: true\n    });\n    watch(activeEnv, env => {\n      store.dispatch('auth/changeEnv', env);\n      router.replace({\n        query: {\n          ...route.query,\n          env\n        }\n      });\n    });\n    const logout = () => {\n      store.dispatch('auth/logout');\n      router.replace({\n        path: '/login',\n        query: {\n          redirect: route.fullPath !== '/login' ? route.fullPath : undefined\n        }\n      });\n    };\n    const setting = Setting;\n    const monitor = Monitor;\n    const collection = Collection;\n    const cpu = Cpu;\n    const __returned__ = {\n      router,\n      route,\n      store,\n      layoutSize,\n      activeEnv,\n      environments,\n      activeMenu,\n      breadcrumb,\n      profile,\n      canViewDashboard,\n      canViewTasks,\n      canViewNodes,\n      canViewConfig,\n      activeEnvLabel,\n      avatarInitials,\n      logout,\n      setting,\n      monitor,\n      collection,\n      cpu,\n      computed,\n      ref,\n      watch,\n      get useRoute() {\n        return useRoute;\n      },\n      get useRouter() {\n        return useRouter;\n      },\n      get useStore() {\n        return useStore;\n      },\n      get Setting() {\n        return Setting;\n      },\n      get Monitor() {\n        return Monitor;\n      },\n      get Collection() {\n        return Collection;\n      },\n      get Cpu() {\n        return Cpu;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["computed","ref","watch","useRoute","useRouter","useStore","Setting","Monitor","Collection","Cpu","router","route","store","layoutSize","activeEnv","getters","environments","activeMenu","path","breadcrumb","profile","canViewDashboard","canViewTasks","canViewNodes","canViewConfig","activeEnvLabel","env","value","find","item","label","avatarInitials","displayName","username","name","slice","toUpperCase","meta","breadcrumbs","crumbs","dispatch","immediate","replace","query","logout","redirect","fullPath","undefined","setting","monitor","collection","cpu"],"sources":["D:/桌面/项目/分布式任务调度系统/SkyTask/skytask-frontend/src/App.vue"],"sourcesContent":["<template>\n  <router-view v-if=\"route.meta?.public\"></router-view>\n  <el-config-provider v-else :size=\"layoutSize\">\n    <div class=\"layout\">\n      <el-container>\n        <el-aside width=\"220px\" class=\"sidebar\">\n          <div class=\"brand\">\n            <span class=\"brand__name\">SkyTask 控制台</span>\n            <span class=\"brand__env\">{{ activeEnvLabel }}</span>\n          </div>\n          <el-menu\n            :default-active=\"activeMenu\"\n            class=\"menu\"\n            router\n            background-color=\"#0f172a\"\n            text-color=\"#f1f5f9\"\n            active-text-color=\"#22d3ee\"\n          >\n            <el-menu-item v-if=\"canViewDashboard\" index=\"/dashboard\">\n              <el-icon><monitor /></el-icon>\n              <span>总览监控</span>\n            </el-menu-item>\n            <el-menu-item v-if=\"canViewTasks\" index=\"/tasks\">\n              <el-icon><collection /></el-icon>\n              <span>任务中心</span>\n            </el-menu-item>\n            <el-menu-item v-if=\"canViewNodes\" index=\"/nodes\">\n              <el-icon><cpu /></el-icon>\n              <span>执行器节点</span>\n            </el-menu-item>\n            <el-menu-item v-if=\"canViewConfig\" index=\"/config\">\n              <el-icon><setting /></el-icon>\n              <span>配置与告警</span>\n            </el-menu-item>\n          </el-menu>\n        </el-aside>\n        <el-container>\n          <el-header class=\"header\">\n            <div class=\"header__left\">\n              <el-breadcrumb separator=\"/\">\n                <el-breadcrumb-item v-for=\"item in breadcrumb\" :key=\"item.path\">\n                  <router-link :to=\"item.path\">{{ item.title }}</router-link>\n                </el-breadcrumb-item>\n              </el-breadcrumb>\n            </div>\n            <div class=\"header__right\">\n              <el-select\n                v-model=\"activeEnv\"\n                placeholder=\"选择环境\"\n                size=\"small\"\n                class=\"env-selector\"\n              >\n                <el-option\n                  v-for=\"env in environments\"\n                  :key=\"env.value\"\n                  :label=\"env.label\"\n                  :value=\"env.value\"\n                />\n              </el-select>\n              <el-dropdown>\n                <span class=\"user\">\n                  <el-avatar size=\"small\">{{ avatarInitials }}</el-avatar>\n                  {{ profile?.displayName || profile?.username || '未登录' }}\n                </span>\n                <template #dropdown>\n                  <el-dropdown-menu>\n                    <el-dropdown-item>{{ profile?.tenantName || '-' }}</el-dropdown-item>\n                    <el-dropdown-item divided @click=\"logout\">退出登录</el-dropdown-item>\n                  </el-dropdown-menu>\n                </template>\n              </el-dropdown>\n            </div>\n          </el-header>\n          <el-main class=\"main\">\n            <router-view />\n          </el-main>\n        </el-container>\n      </el-container>\n    </div>\n  </el-config-provider>\n</template>\n\n<script setup>\nimport { computed, ref, watch } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nimport { useStore } from 'vuex';\nimport { Setting, Monitor, Collection, Cpu } from '@element-plus/icons-vue';\n\nconst router = useRouter();\nconst route = useRoute();\nconst store = useStore();\n\nconst layoutSize = ref('default');\nconst activeEnv = ref(store.getters['auth/currentEnv']);\nconst environments = computed(() => store.getters['auth/environments']);\nconst activeMenu = computed(() => route.path);\nconst breadcrumb = computed(() => store.getters['ui/breadcrumbs']);\nconst profile = computed(() => store.getters['auth/profile']);\n\nconst canViewDashboard = computed(() => store.getters['auth/hasPermission']('task:read'));\nconst canViewTasks = computed(() => store.getters['auth/hasPermission']('task:read'));\nconst canViewNodes = computed(() => store.getters['auth/hasPermission']('node:read'));\nconst canViewConfig = computed(() => store.getters['auth/hasPermission']('config:write'));\n\nconst activeEnvLabel = computed(() => {\n  const env = environments.value.find((item) => item.value === activeEnv.value);\n  return env ? env.label : '未知环境';\n});\n\nconst avatarInitials = computed(() => {\n  if (!profile.value?.displayName && !profile.value?.username) {\n    return 'NA';\n  }\n  const name = profile.value.displayName || profile.value.username;\n  return name.slice(0, 2).toUpperCase();\n});\n\nwatch(\n  () => route.meta?.breadcrumbs,\n  (crumbs) => {\n    store.dispatch('ui/setBreadcrumbs', crumbs || []);\n  },\n  { immediate: true }\n);\n\nwatch(activeEnv, (env) => {\n  store.dispatch('auth/changeEnv', env);\n  router.replace({ query: { ...route.query, env } });\n});\n\nconst logout = () => {\n  store.dispatch('auth/logout');\n  router.replace({ path: '/login', query: { redirect: route.fullPath !== '/login' ? route.fullPath : undefined } });\n};\n\nconst setting = Setting;\nconst monitor = Monitor;\nconst collection = Collection;\nconst cpu = Cpu;\n</script>\n\n<style scoped lang=\"scss\">\n.layout {\n  min-height: 100vh;\n  background: #0f172a;\n\n  .sidebar {\n    background: #0f172a;\n    box-shadow: inset -1px 0 0 rgba(148, 163, 184, 0.1);\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 16px;\n  }\n\n  .brand {\n    display: flex;\n    flex-direction: column;\n    padding: 24px 16px;\n    color: #e2e8f0;\n    border-bottom: 1px solid rgba(148, 163, 184, 0.15);\n\n    &__name {\n      font-size: 18px;\n      font-weight: 600;\n      letter-spacing: 0.5px;\n    }\n\n    &__env {\n      font-size: 12px;\n      color: #38bdf8;\n      margin-top: 4px;\n    }\n  }\n\n  .menu {\n    border-right: none;\n    flex: 1;\n    background: transparent;\n  }\n\n  .header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0 24px;\n    background: linear-gradient(90deg, rgba(15, 23, 42, 0.9), rgba(30, 41, 59, 0.85));\n    color: #f1f5f9;\n    box-shadow: 0 1px 4px rgba(15, 23, 42, 0.3);\n\n    .header__left {\n      display: flex;\n      align-items: center;\n\n      .el-breadcrumb {\n        font-size: 14px;\n\n        a {\n          color: #bae6fd;\n        }\n      }\n    }\n\n    .header__right {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n\n      .env-selector {\n        width: 160px;\n      }\n\n      .user {\n        display: inline-flex;\n        align-items: center;\n        gap: 8px;\n        cursor: pointer;\n        color: #e2e8f0;\n      }\n    }\n  }\n\n  .main {\n    padding: 24px;\n    background: #e2e8f0;\n    min-height: calc(100vh - 64px);\n  }\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}