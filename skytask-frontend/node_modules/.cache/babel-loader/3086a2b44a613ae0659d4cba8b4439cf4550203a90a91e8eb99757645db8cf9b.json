{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, withKeys as _withKeys, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"login-page\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_form = _resolveComponent(\"el-form\");\n  const _component_el_card = _resolveComponent(\"el-card\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_el_card, {\n    class: \"login-card\",\n    shadow: \"always\"\n  }, {\n    header: _withCtx(() => [...(_cache[3] || (_cache[3] = [_createElementVNode(\"div\", {\n      class: \"login-card__header\"\n    }, [_createElementVNode(\"h2\", null, \"SkyTask 平台\"), _createElementVNode(\"p\", null, \"请输入租户、用户名和密码登录\")], -1 /* CACHED */)]))]),\n    default: _withCtx(() => [_createVNode(_component_el_form, {\n      ref: \"loginFormRef\",\n      model: $setup.loginForm,\n      rules: $setup.loginRules,\n      \"label-width\": \"80px\",\n      onSubmit: _withModifiers($setup.handleLogin, [\"prevent\"])\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_form_item, {\n        label: \"租户\",\n        prop: \"tenantCode\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: $setup.loginForm.tenantCode,\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.loginForm.tenantCode = $event),\n          placeholder: \"例如: tenant-alpha\",\n          autocomplete: \"off\"\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"用户名\",\n        prop: \"username\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: $setup.loginForm.username,\n          \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.loginForm.username = $event),\n          placeholder: \"请输入用户名\",\n          autocomplete: \"username\"\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"密码\",\n        prop: \"password\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: $setup.loginForm.password,\n          \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.loginForm.password = $event),\n          type: \"password\",\n          placeholder: \"请输入密码\",\n          \"show-password\": \"\",\n          autocomplete: \"current-password\",\n          onKeyup: _withKeys($setup.handleLogin, [\"enter\"])\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, null, {\n        default: _withCtx(() => [_createVNode(_component_el_button, {\n          type: \"primary\",\n          style: {\n            \"width\": \"100%\"\n          },\n          loading: $setup.loading,\n          onClick: $setup.handleLogin\n        }, {\n          default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.loading ? '登录中...' : '登录'), 1 /* TEXT */)]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"loading\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"model\"]), _cache[4] || (_cache[4] = _createElementVNode(\"div\", {\n      class: \"login-card__footer\"\n    }, [_createElementVNode(\"p\", null, \"演示租户: tenant-alpha | 演示账号: ops-admin / admin123\")], -1 /* CACHED */))]),\n    _: 1 /* STABLE */\n  })]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_el_card","shadow","header","_withCtx","_cache","_createElementVNode","_component_el_form","ref","model","$setup","loginForm","rules","loginRules","onSubmit","_withModifiers","handleLogin","_component_el_form_item","label","prop","_component_el_input","tenantCode","$event","placeholder","autocomplete","username","password","type","onKeyup","_withKeys","_component_el_button","style","loading","onClick"],"sources":["D:\\桌面\\项目\\分布式任务调度系统\\SkyTask-main\\SkyTask-main\\skytask-frontend\\src\\views\\LoginView.vue"],"sourcesContent":["<template>\n  <div class=\"login-page\">\n    <el-card class=\"login-card\" shadow=\"always\">\n      <template #header>\n        <div class=\"login-card__header\">\n          <h2>SkyTask 平台</h2>\n          <p>请输入租户、用户名和密码登录</p>\n        </div>\n      </template>\n\n      <el-form\n        ref=\"loginFormRef\"\n        :model=\"loginForm\"\n        :rules=\"loginRules\"\n        label-width=\"80px\"\n        @submit.prevent=\"handleLogin\"\n      >\n        <el-form-item label=\"租户\" prop=\"tenantCode\">\n          <el-input\n            v-model=\"loginForm.tenantCode\"\n            placeholder=\"例如: tenant-alpha\"\n            autocomplete=\"off\"\n          />\n        </el-form-item>\n        <el-form-item label=\"用户名\" prop=\"username\">\n          <el-input\n            v-model=\"loginForm.username\"\n            placeholder=\"请输入用户名\"\n            autocomplete=\"username\"\n          />\n        </el-form-item>\n        <el-form-item label=\"密码\" prop=\"password\">\n          <el-input\n            v-model=\"loginForm.password\"\n            type=\"password\"\n            placeholder=\"请输入密码\"\n            show-password\n            autocomplete=\"current-password\"\n            @keyup.enter=\"handleLogin\"\n          />\n        </el-form-item>\n        <el-form-item>\n          <el-button\n            type=\"primary\"\n            style=\"width: 100%\"\n            :loading=\"loading\"\n            @click=\"handleLogin\"\n          >\n            {{ loading ? '登录中...' : '登录' }}\n          </el-button>\n        </el-form-item>\n      </el-form>\n\n      <div class=\"login-card__footer\">\n        <p>演示租户: tenant-alpha | 演示账号: ops-admin / admin123</p>\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script setup>\nimport { reactive, ref } from 'vue';\nimport { useRouter, useRoute } from 'vue-router';\nimport { useStore } from 'vuex';\nimport { ElMessage } from 'element-plus';\n\nconst store = useStore();\nconst router = useRouter();\nconst route = useRoute();\n\nconst loginFormRef = ref(null);\nconst loading = ref(false);\nconst loginForm = reactive({\n  tenantCode: 'tenant-alpha',\n  username: '',\n  password: ''\n});\n\nconst loginRules = {\n  tenantCode: [\n    { required: true, message: '请输入租户代码', trigger: 'blur' }\n  ],\n  username: [\n    { required: true, message: '请输入用户名', trigger: 'blur' },\n    { min: 3, max: 32, message: '用户名长度为3-32个字符', trigger: 'blur' }\n  ],\n  password: [\n    { required: true, message: '请输入密码', trigger: 'blur' },\n    { min: 6, message: '密码长度至少6个字符', trigger: 'blur' }\n  ]\n};\n\nconst handleLogin = async () => {\n  if (!loginFormRef.value) {\n    return;\n  }\n  try {\n    const valid = await loginFormRef.value.validate();\n    if (!valid) {\n      return;\n    }\n  } catch {\n    return;\n  }\n\n  loading.value = true;\n  try {\n    const payload = {\n      tenantCode: loginForm.tenantCode,\n      username: loginForm.username,\n      password: loginForm.password\n    };\n    const response = await store.dispatch('auth/login', payload);\n    ElMessage.success(`Welcome back, ${response.displayName || response.username}`);\n\n    const redirect = route.query.redirect || '/dashboard';\n    router.push(redirect);\n  } catch (error) {\n    const status = error.response?.status;\n    let message = error.response?.data?.message || error.message;\n    if (status === 401) {\n      message = 'Incorrect username or password';\n    } else if (status === 404) {\n      message = 'Tenant does not exist';\n    } else if (!message) {\n      message = 'Sign-in failed, please try again later';\n    }\n    ElMessage.error(message);\n  } finally {\n    loading.value = false;\n  }\n};\n</script>\n\n<style scoped lang=\"scss\">\n.login-page {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-height: 100vh;\n  background: linear-gradient(135deg, #0f172a, #1e293b);\n  padding: 32px 16px;\n}\n\n.login-card {\n  width: 420px;\n  border-radius: 16px;\n  box-shadow: 0 18px 45px rgba(15, 23, 42, 0.35);\n\n  &__header {\n    text-align: center;\n\n    h2 {\n      margin: 0 0 8px;\n      font-size: 24px;\n      color: #0f172a;\n    }\n\n    p {\n      margin: 0;\n      font-size: 14px;\n      color: #64748b;\n    }\n  }\n\n  &__footer {\n    margin-top: 16px;\n    text-align: center;\n    font-size: 12px;\n    color: #94a3b8;\n  }\n}\n</style>\n\n\n\n\n"],"mappings":";;EACOA,KAAK,EAAC;AAAY;;;;;;;uBAAvBC,mBAAA,CAwDM,OAxDNC,UAwDM,GAvDJC,YAAA,CAsDUC,kBAAA;IAtDDJ,KAAK,EAAC,YAAY;IAACK,MAAM,EAAC;;IACtBC,MAAM,EAAAC,QAAA,CACf,MAGM,KAAAC,MAAA,QAAAA,MAAA,OAHNC,mBAAA,CAGM;MAHDT,KAAK,EAAC;IAAoB,IAC7BS,mBAAA,CAAmB,YAAf,YAAU,GACdA,mBAAA,CAAqB,WAAlB,gBAAc,E;sBAIrB,MAyCU,CAzCVN,YAAA,CAyCUO,kBAAA;MAxCRC,GAAG,EAAC,cAAc;MACjBC,KAAK,EAAEC,MAAA,CAAAC,SAAS;MAChBC,KAAK,EAAEF,MAAA,CAAAG,UAAU;MAClB,aAAW,EAAC,MAAM;MACjBC,QAAM,EAAAC,cAAA,CAAUL,MAAA,CAAAM,WAAW;;wBAE5B,MAMe,CANfhB,YAAA,CAMeiB,uBAAA;QANDC,KAAK,EAAC,IAAI;QAACC,IAAI,EAAC;;0BAC5B,MAIE,CAJFnB,YAAA,CAIEoB,mBAAA;sBAHSV,MAAA,CAAAC,SAAS,CAACU,UAAU;qEAApBX,MAAA,CAAAC,SAAS,CAACU,UAAU,GAAAC,MAAA;UAC7BC,WAAW,EAAC,kBAAkB;UAC9BC,YAAY,EAAC;;;UAGjBxB,YAAA,CAMeiB,uBAAA;QANDC,KAAK,EAAC,KAAK;QAACC,IAAI,EAAC;;0BAC7B,MAIE,CAJFnB,YAAA,CAIEoB,mBAAA;sBAHSV,MAAA,CAAAC,SAAS,CAACc,QAAQ;qEAAlBf,MAAA,CAAAC,SAAS,CAACc,QAAQ,GAAAH,MAAA;UAC3BC,WAAW,EAAC,QAAQ;UACpBC,YAAY,EAAC;;;UAGjBxB,YAAA,CASeiB,uBAAA;QATDC,KAAK,EAAC,IAAI;QAACC,IAAI,EAAC;;0BAC5B,MAOE,CAPFnB,YAAA,CAOEoB,mBAAA;sBANSV,MAAA,CAAAC,SAAS,CAACe,QAAQ;qEAAlBhB,MAAA,CAAAC,SAAS,CAACe,QAAQ,GAAAJ,MAAA;UAC3BK,IAAI,EAAC,UAAU;UACfJ,WAAW,EAAC,OAAO;UACnB,eAAa,EAAb,EAAa;UACbC,YAAY,EAAC,kBAAkB;UAC9BI,OAAK,EAAAC,SAAA,CAAQnB,MAAA,CAAAM,WAAW;;;UAG7BhB,YAAA,CASeiB,uBAAA;0BARb,MAOY,CAPZjB,YAAA,CAOY8B,oBAAA;UANVH,IAAI,EAAC,SAAS;UACdI,KAAmB,EAAnB;YAAA;UAAA,CAAmB;UAClBC,OAAO,EAAEtB,MAAA,CAAAsB,OAAO;UAChBC,OAAK,EAAEvB,MAAA,CAAAM;;4BAER,MAA+B,C,kCAA5BN,MAAA,CAAAsB,OAAO,mC;;;;;;4DAKhB1B,mBAAA,CAEM;MAFDT,KAAK,EAAC;IAAoB,IAC7BS,mBAAA,CAAsD,WAAnD,iDAA+C,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}